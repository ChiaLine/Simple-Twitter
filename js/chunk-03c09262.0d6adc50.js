(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03c09262"],{1206:function(e,t,a){"use strict";a("748b")},"20e2":function(e,t,a){},"6a90":function(e,t,a){"use strict";a("20e2")},"748b":function(e,t,a){},cd56:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("UserCreateTweet",{on:{"after-show-tweet-modal":e.afterShowModal}}),a("TweetCards",{on:{"after-show-reply-modal":e.afterShowReplyModal}})],1)},s=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("p",{staticClass:"tweet-title"},[e._v("首頁")]),a("div",{staticClass:"create-tweet-card",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleTweetButtonCard()}}},[a("div",{staticClass:"tweet-card-img-container"},[a("img",{staticClass:"tweet-card-img",attrs:{src:e._f("emptyImage")(e.currentUser.avatar)}})]),a("span",{staticClass:"tweet-card-title"},[e._v("有什麼新鮮事?")]),a("button",{staticClass:"tweet-card-button",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleTweetButtonCard()}}},[e._v(" 推文 ")])])])},i=[],c=a("5530"),o=a("2f62"),l=a("2708"),u={name:"userCreateTweet",mixins:[l["a"]],data:function(){return{}},computed:Object(c["a"])({},Object(o["b"])(["currentUser"])),methods:{handleTweetButtonCard:function(){console.log("show modal"),this.$emit("after-show-tweet-modal")}}},d=u,p=(a("6a90"),a("2877")),w=Object(p["a"])(d,n,i,!1,null,null,null),f=w.exports,m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tweet-cards"},e._l(e.tweetCards,(function(t){return a("div",{key:t.id,staticClass:"tweet-card"},[a("div",{staticClass:"tweet-card-top"},[a("div",{staticClass:"tweet-card-avatar"},[a("div",{on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.toUserPage.apply(null,arguments)}}},[a("img",{staticClass:"tweet-card-img",attrs:{"data-userId":t.UserId,src:e._f("emptyImage")(t.tweetedUser.avatar)}})])]),a("div",{staticClass:"tweet-card-content",attrs:{"data-cardId":t.id},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.toReplyList.apply(null,arguments)}}},[a("div",[a("span",{staticClass:"tweet-card-name",attrs:{"data-cardId":t.id}},[e._v(e._s(t.tweetedUser.name))]),a("span",{staticClass:"tweet-card-account",attrs:{"data-cardId":t.id}},[e._v(" @"+e._s(t.tweetedUser.account)+"．"+e._s(e._f("formatDate")(t.createdAt))+" ")]),a("p",{staticClass:"tweet-card-description",attrs:{"data-cardId":t.id}},[e._v(" "+e._s(t.description)+" ")])])])]),a("div",{staticClass:"tweet-card-icons"},[a("button",{staticClass:"tweet-reply-icon",on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.handleTweetCardReplyButton(t.id)}}},[a("img",{staticClass:"icon-reply",attrs:{src:e.iconReply}}),a("span",[e._v(e._s(t.totalReplies))])]),t.isLiked?a("button",{staticClass:"tweet-like-icon",attrs:{disabled:e.isProcessing},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.deleteTweetLike(t.id)}}},[a("img",{staticClass:"icon-like",attrs:{src:e.iconIsLike}}),a("span",[e._v(e._s(t.totalLikes))])]):a("button",{staticClass:"tweet-like-icon",attrs:{disabled:e.isProcessing},on:{click:function(a){return a.stopPropagation(),a.preventDefault(),e.addTweetCardLike(t.id)}}},[a("img",{staticClass:"icon-like",attrs:{src:e.iconUnLike}}),a("span",[e._v(e._s(t.totalLikes))])])])])})),0)},h=[],g=a("1da1"),v=(a("a9e3"),a("96cf"),a("e02c")),C=a("2fa3"),k={name:"TweetCards",data:function(){return{tweetCards:[],iconUnLike:"https://i.imgur.com/fWY8yOj.png",iconIsLike:"https://i.imgur.com/LQTMNI0.png",iconReply:"https://i.imgur.com/EwJRYkP.png",isProcessing:!1}},mixins:[l["a"],l["b"]],created:function(){this.fetchTweetCards()},computed:Object(c["a"])({},Object(o["b"])(["currentUser"])),methods:{fetchTweetCards:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v["a"].getTweetCards();case 3:a=t.sent,r=a.data,e.tweetCards=r,t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),console.error(t.t0),C["a"].fire({icon:"error",title:t.t0.response.data.message});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},handleTweetCardReplyButton:function(e){console.log("show reply nodal",e),this.$emit("after-show-reply-modal",e)},addTweetCardLike:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.isProcessing=!0,console.log(e),a.next=5,v["a"].addTweetLike(e);case 5:return a.next=7,t.fetchTweetCards();case 7:C["a"].fire({icon:"success",title:"成功加入喜歡的內容"}),t.isProcessing=!1,a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](0),t.isProcessing=!1,C["a"].fire({icon:"error",title:a.t0.response.data.message});case 15:case"end":return a.stop()}}),a,null,[[0,11]])})))()},deleteTweetLike:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.isProcessing=!0,a.next=4,v["a"].deleteTweetLike(e);case 4:return a.next=6,t.fetchTweetCards();case 6:C["a"].fire({icon:"success",title:"成功取消喜歡的內容"}),t.isProcessing=!1,a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](0),t.isProcessing=!1,C["a"].fire({icon:"error",title:a.t0.response.data.message});case 14:case"end":return a.stop()}}),a,null,[[0,10]])})))()},toReplyList:function(e){var t=e.target.dataset.cardid;t&&this.$router.push({name:"ReplyList",params:{id:t}})},toUserPage:function(e){var t=Number(e.target.dataset.userid),a=this.currentUser.id;t===a?this.$router.push({name:"UserSelf"}):t&&this.$router.push({name:"UserOther",params:{id:t}})}}},b=k,T=(a("1206"),Object(p["a"])(b,m,h,!1,null,null,null)),_=T.exports,y={name:"UserMain",components:{UserCreateTweet:f,TweetCards:_},data:function(){return{showModal:!1}},methods:{afterShowModal:function(){console.log("afterShowModal----main"),this.$emit("after-show-tweet-modal")},afterShowReplyModal:function(e){console.log("afterShowReplyModal----main",e),this.$emit("after-show-reply-modal",e)}}},L=y,P=Object(p["a"])(L,r,s,!1,null,null,null);t["default"]=P.exports},e02c:function(e,t,a){"use strict";var r=a("2fa3"),s=function(){return localStorage.getItem("token")};t["a"]={getTweetCards:function(){return r["b"].get("/tweets",{headers:{Authorization:"Bearer ".concat(s())}})},addTweetLike:function(e){return r["b"].post("/tweets/".concat(e,"/like"),null,{headers:{Authorization:"Bearer ".concat(s())}})},deleteTweetLike:function(e){return r["b"].post("/tweets/".concat(e,"/unlike"),null,{headers:{Authorization:"Bearer ".concat(s())}})}}}}]);
//# sourceMappingURL=chunk-03c09262.0d6adc50.js.map